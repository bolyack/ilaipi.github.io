---
layout: post
title: maven使用总结
category: maven
keywords: maven 私服 deploy
---

# 设置重复部署

在开发环境可以执行mvn deploy命令把相应的jar包上传到私服,
但是当相同的版本号重复执行deploy命令时，可能会得到400的response code.
这时候设置方法：
登录私服，打开Repositories面板，
选择Release/Snapshots仓库，在Configuration面板，
中间块Access Settings中设置Deployment Policy值为 Allow Redeploy，
点击下面的保存按钮即可

# mvn deploy命令

需要相关的配置才能把jar包放到私服，配置包括：
pom.xml中：

```
    //distributionManagement元素
    <distributionManagement>
        <repository>
            <id>releases</id>
            <name>Nexus Release Repository</name>
            <url>${baseUrl}:8099/nexus/content/repositories/releases/</url>
        </repository>
        <snapshotRepository>
            <id>snapshots</id>
            <name>Nexus Snapshots Repository</name>
            <url>${baseUrl}:8099/nexus/content/repositories/snapshots/</url>
        </snapshotRepository>
    </distributionManagement>
```

maven的settings.xml中：

```
    //server元素，为distributionManagement元素指定用户名密码
    <server>
      <id>snapshots</id>
      <username>deployment</username>
      <password>123456</password>
    </server>
    <server>
      <id>releases</id>
      <username>deployment</username>
      <password>123456</password>
    </server>
```

# 私服中设置deployment用户权限

当以上两步执行完成后，可能会出现403的response code，可能是没有权限。
登录私服，在左侧找到Security -> Users，选择deployment用户，
在下面Config面板添加角色：Nexus Deployment Role和Repo: All Repositories (Full Control)
然后在deployment用户名右击重置密码